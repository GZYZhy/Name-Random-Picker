## USEAGE 使用教程

以下是针对 Windows 操作系统的使用教程，适用于版本 V4.0.0 及以上。

### 安装

  1. 前往[Release](https://github.com/gzyzhy/name-random-picker/releases)下载最新版安装包 (randompicker_installer.exe)
  2. 运行安装包，选择合适的安装路径，安装本程序。

### 开始抽签

  双击桌面红色的“随机抽签器”快捷方式，您会看到以下启动提示（启动提示弹窗会自动关闭）：
  
  ![启动提示](https://s21.ax1x.com/2025/03/25/pEDi3QJ.png)
  左键单击（对于触屏电子白板：点击）左下角蓝色方块，即可从姓名列表里抽取出一个姓名，类似这样：

  ![抽取效果](https://s21.ax1x.com/2025/03/25/pEDiGLR.png)

  同时系统会朗读出被抽到者的姓名。此名字不会再次被抽中，除非您设置的名单中所有人都已经被抽到了一遍。您也可以通过“右键方块-重置个人/重置小组”来手动重置抽取记忆。

  再次单击蓝色方块即可关闭写有被抽到者姓名的中央窗口。如果您不这样做，中心窗口不会自动关闭。这可以确保您准确地知道被抽到的是谁。

  如果点击红色方块，则会从小组列表里抽取出一个小组，并显示在中心窗口上。再次单击红色方块即可关闭中心窗口。

### 编辑配置

  安装成功后，必须进行配置编辑才能正确为您的情况服务。注意：不建议直接编辑config.json，建议按本说明的步骤操作。

  右键（对于触屏电子白板：长按）蓝色或红色方块，会弹出右键菜单：

  ![右键菜单](https://s21.ax1x.com/2025/03/25/pEDk9gg.png)

  选择“编辑配置”选项，会打开配置文件编辑器。编辑配置后，请记得点击“保存”，然后右键蓝色或红色方块，选择“重读配置”来使改动生效。

  ![配置编辑器](https://s21.ax1x.com/2025/03/25/pEDkEEq.png)

  #### 通过Excel来导入配置（推荐）

  点击菜单栏中的“导入/导出”选项，选择“生成Excel模版”，可以在您选择的路径生成一份本程序可读的Excel文件。同时还会在同一目录下生成一份编辑说明txt文件，您只需按此说明将表格填充完整即可。

  注：姓名与分组无需对应，两者之间其实没有关系。您完全可以将所有名字依次填在“姓名”列，将所有小组组号依次填在“分组”列，而不必将组员姓名与组号对应。彩蛋的相关说明，请往后查看“手动配置”一节。

  ![Excel](https://s21.ax1x.com/2025/03/25/pEDkU2D.png)

  编辑好后，选择菜单栏中“导入/导出-从Excel导入”，选择编辑好的Excel文件，确认预览数据无误，点击“导入”

  ![导入](https://s21.ax1x.com/2025/03/25/pEDk4qs.png)
  您也可以将当前配置导出为一个Excel来保存您的配置。

  #### 手动配置

  您可以直接通过编辑器的界面来进行配置编辑。以下是详细步骤。

  - 姓名管理

  ![姓名配置](https://s21.ax1x.com/2025/03/25/pEDelAs.md.png)

  点击“添加”来添加一个姓名，在已有列表中选中一个或多个姓名后点击“删除”来删除这些姓名，点击“清空”可以删除所有姓名。

  注：序号仅代表词姓名在配置文件中的位置，与抽取顺序、学号、分组等无关，不支持编辑。删除姓名会导致其所对应的彩蛋一并被删除。

  - 分组管理
    
  ![分组管理](https://s21.ax1x.com/2025/03/25/pEDm92V.png)

  配置方法基本与上节姓名的配置相同。

  - 个人彩蛋

  可以通过配置实现抽到某个人时展示为类似下面这种效果：

  ![彩蛋示例](https://s21.ax1x.com/2025/03/25/pEDmlrD.png)

  本例中，抽到“示例姓名1”时，设置了字体颜色为蓝色，展示为“示例姓名1的展示名”而非默认的“示例姓名1”，在中央姓名框以外展示一张图片，播放一段背景音频，朗读时读作“示例姓名1的朗读名”而不是默认的“示例姓名1”。

  其配置参数如下：

  ![彩蛋配置](https://s21.ax1x.com/2025/03/25/pEDm8VH.png)

  按照编辑窗口的说明来编辑即可。

  注：如果您想要将您的彩蛋配置引用的音频/图片放在程序运行目录下，强烈建议您将其放在src文件夹中，以免程序更新时文件被覆盖。

  我们相信此功能能给您的课堂带来一些趣味，同时提高本程序的可玩性。如您不需要此功能，清空彩蛋配置即可。如您需要临时关闭彩蛋功能而只是正常显示和朗读（例如应对公开课），可以右键红色或蓝色方块，选择“关闭彩蛋”，无需编辑配置文件。

  - 小组彩蛋

  与上节个人彩蛋的配置相同。

### 其他功能

  - 测试模式

  您可以右键方块-选择“测试模式”，然后在弹出的框中输入您要测试效果的姓名或组号来测试抽到Ta时会产生的效果。这在彩蛋调试中非常有用。您也可以通过这个功能来“指定”抽到此人（虽然这样做没什么意义）。

  - 请假名单

  ![请假配置](https://s21.ax1x.com/2025/03/25/pEDmTo9.png)

  某人临时请假/有某种原因暂时不适合被抽到？不用费劲编辑配置文件，只需右键方块-选择“请假名单”将其添加到请假名单中即可。Ta将不会在抽取中出现。

  注：重新运行程序会清空请假名单！

  - 移动窗口

  方块窗口在默认的左下角不方便？右键-“移动窗口”即可使窗口变为可以拖动的状态。再次右键-“锁定窗口”即可使方块固定在此位置。

  - 任务栏、托盘图标与窗口置顶

  为了确保您在PPT放映、视频全屏等情境下仍能顺畅的进行抽取，我们设置了方块窗口半透明且永久置顶。为避免让您的任务栏拥挤，程序运行时不会在任务栏中出现图标，但会在系统托盘中展示图标。您可以通过右键方块-“退出”或者右键托盘图标-“退出”来结束本程序。

  如果需要暂时隐藏方块窗口，可以通过右键托盘图标-“显示/隐藏”来改变方块窗口的可见状态。

  ![托盘图标](https://s21.ax1x.com/2025/03/25/pEDniWt.png)

### 错误处理
  - 抽取时报错“您的系统不支持朗读，后续将自动禁用朗读功能”

  这通常意味着您的系统没有安装 Windows 默认带有的 TTS 语音合成 API。您可以根据弹窗中具体的报错信息进行排查。

  - 启动报错“配置文件错误”

  这一般是由于您直接编辑了config.json或者改变了彩蛋配置中引用的音频/图片所在路径。请按弹窗报错提示核查您的配置文件的语法。我们仍十分建议您通过配置文件编辑器来编辑配置。如果由于配置文件出错而导致主程序无法运行，您可以手动运行程序安装目录下的 editor.exe 来在主程序不运行的情况下启动配置文件编辑器。
  
### 更新

- 您可以右键方块-“关于”来查看您运行的程序版本。
- 当前最新版本，请查看[Releases](https://github.com/gzyzhy/name-random-picker/releases)中的Latest版本。
- 编写不易，麻烦给个GitHub星星吧🌟🌟🌟
- 如发现运行异常，请报告Issue。
  

  

  

  
